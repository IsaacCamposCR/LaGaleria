<div>
    <h1>{{model.title}}</h1>

    <ng-form name="reservationForm">
        <fieldset ng-disabled="model.disableForm">
            <div>
                <client-lookup-component client-id="model.clientId" />
            </div>
            <hr/>
            <div>
                <label for="invoice"># de Documento: </label>
                <input id="invoice" type="text" ng-model="model.invoice">
                <input type="checkbox" ng-model="model.isReservation" ng-change="model.makeReservation()">Apartado
                <br/>
                <label for="date">Fecha: </label>
                <input name="date" type="date" ng-model="model.date" required>
                <p ng-show="reservationForm.date.$invalid">La fecha de ingreso del cliente no es valida.</p>
                <br/>
                <div>
                    <label for="price">Precio Total: </label>
                    <money-input id="price" text="model.price" ng-keyup="model.updatePrice()"></money-input>
                    <button type="button" ng-click="model.resetPrice()">Reestablecer</button>
                </div>
                <label for="remaining">Saldo: </label>
                <span id="remaining">{{model.remaining | currency}}</span>
                <hr/>
                <div>
                    <h3>Articulos:</h3>
                    <div>
                        <label for="article">Buscar Articulo: </label>
                        <input id="article" type="text" ng-model="model.article" ng-keyup="model.beginArticleSearch()" autocomplete="off">
                        <div ng-show="model.lookupArticle" ng-click="model.selectArticle(article._id)" ng-repeat="article in model.lookupArticles">
                            <span>{{article.description}}: {{article.price | currency}} - {{article.stock}} restantes.</span>
                        </div>
                    </div>
                    <ul>
                        <li ng-repeat="article in model.articles track by $index" ng-if="article.quantity">
                            <div>
                                {{article.description}} - {{article.price | currency}} X {{article.quantity}}: {{(article.price * article.quantity) | currency}}
                                <button type="button" ng-click="model.addArticle(article._id)">+</button>
                                <button type="button" ng-click="model.removeArticle(article._id, $index)">-</button>
                            </div>
                        </li>
                    </ul>
                </div>
                <hr/>
                <div ng-if="model.isReservation">
                    <advance-component advances="model.advances" remaining="model.remaining" display-totals="model.displayTotals()" />
                </div>
            </div>
        </fieldset>
        <div ng-show="!model.pop">
            <button ng-disabled="!reservationForm.$valid" ng-if="!model.editingReservation" type="submit" ng-click="model.saveReservation()">Guardar</button>
            <button type="button" ng-if="model.editingReservation" ng-click="model.editReservation()">Editar</button>
            <button type="button" ng-click="model.cancelEditReservation()">Cancelar</button>
        </div>
    </ng-form>
    <message type="model.messageType" message="model.message" show="model.pop" confirm="model.confirm()" cancel="model.cancel()"></message>
</div>